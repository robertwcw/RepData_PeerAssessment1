---
title: "RepData_PeerAssessment1"
author: "robertwcw"
date: "9/7/2020"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

This assignment makes use of the data collected from a personal activity monitoring device, that captures data at 5 minute intervals through out the day on the number of steps taken by an anonymous individual in daily activities during the months of November and October in 2012. The device that was used to capture the steps data is part of the “quantified self” movement – a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. 

The data set in CSV format is available here: [Activity monitoring data](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip).

Each row in the data set consists of three variables recorded the total number of steps performed in daily activities in every 5 minutes each day consecutively for two months.

The variables included in the data set are:  
1. **steps** (Numeric): Number of steps taken by the anonymous individual in 5-minute interval.  
2. **date** (Date): The date (YYYY-MM-DD) which the measurements were taken.  
3. **interval** (Numeric): Identifier for the 5-minute interval for which the observation was captured.  

**<data.load>**  
1. load data set into R environment.  
2. take-a-peek (manual) at the unzipped data set to determine number of file in the set, data format and the presence of header...etc.  

<!-- filels <- as.list(unzip(filetmp, list = TRUE)) -->
<!-- filels$Name #display file name & file type. -->
<!-- length(filels$Name) #display number of files in the data set. -->
<!-- filels$Length #display physical file size -->
<!-- length(readLines(filels$Name[i])) - 1 #display row count (text-file only) -->
<!-- readLines(filels$Name[i], n = 5) #display first 5 lines. (text-file only) -->

```{r data.load, message = FALSE}
filetmp <- tempfile()
datadir <- paste(".", "data", sep = "/")
fileurl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file(fileurl, filetmp)

if (!dir.exists(datadir)) 
    {
        dir.create(datadir)
    }

unzip(filetmp, exdir = datadir, overwrite = TRUE)
filels <- as.list(unzip(filetmp, list = TRUE))
filein <- as.character()
filesrc <- as.character()

library(readr)
for (i in 1:length(filels$Name)) 
    {
        filesrc <- paste(datadir, filels$Name[[i]], sep = "/")
        filein <- strsplit(filels$Name[[i]], ".", fixed = TRUE)[[1]][1]
        assign(filein, read_csv(filesrc))
    }
detach("package:readr", unload = TRUE)

unlink(filetmp)
rm(filetmp, fileurl, filein, filesrc, i)
```
  
**<data.eval>**  
Perform brief evaluation on the data set if there are missing values.
e.g. NA, NaN or NULL  
```{r data.eval}
summary(activity)
colMeans(is.na(activity))
```

**<data.prep>**
```{r data.prep, results = "hide"}
library(impute)
imputed.activity <- impute.knn(data.matrix(activity), k = 15)$data
activity$steps <- imputed.activity[,1]
detach("package:impute", unload = TRUE)
```
After imputation of missing values 'NA' in the data set.
```{r}
summary(activity)
```

Histogram of the total number of steps taken for each day.
```{r total_steps}
library(dplyr)
totalsteps <- activity %>% 
                    select(date, steps) %>%
                    group_by(date) %>%
                    summarise(steps = sum(steps))
detach("package:dplyr", unload = TRUE)
```






```{r house.keeping}
# detach("package:readr", unload = TRUE)
# detach("package:tidyr", unload = TRUE)
```
